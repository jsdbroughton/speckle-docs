(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{618:function(s,t,e){"use strict";e.r(t);var a=e(44),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"deploying-a-server-manual-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploying-a-server-manual-setup"}},[s._v("#")]),s._v(" Deploying a Server - manual setup")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("IMPORTANT")]),s._v(" "),e("p",[s._v("We offer a free server that you can use straight away (create accounts, etc.).")]),s._v(" "),e("p",[s._v("We can also help you manage your Server deployments (setting things up securely, automatic upgrades, support, etc)")]),s._v(" "),e("p",[s._v("See "),e("a",{attrs:{href:"https://speckle.systems/getstarted/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://speckle.systems/getstarted/"),e("OutboundLink")],1),s._v(" for more details on our offerings.")])]),s._v(" "),e("p",[s._v("If you want to run your own instance, there are multiple ways to achieve this:")]),s._v(" "),e("ul",[e("li",[s._v("The easiest way is to use our precompiled releases that are available as docker images on Docker Hub.")]),s._v(" "),e("li",[s._v("If you want to deploy the Server with your own modifications, you should build your own docker images (instructions below).")]),s._v(" "),e("li",[s._v("Also, you can run the Server with local development tools needed for each package (requires development knowledge)")])]),s._v(" "),e("h3",{attrs:{id:"dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dependencies"}},[s._v("#")]),s._v(" Dependencies")]),s._v(" "),e("p",[s._v("The Speckle server needs two services available over the network:")]),s._v(" "),e("ul",[e("li",[s._v("PostgreSQL (tested with v12 and v13)")]),s._v(" "),e("li",[s._v("Redis")]),s._v(" "),e("li",[s._v("Optional: S3-compatible Object Storage")])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("PostgreSQL, Redis and MinIO are included in the following deployment instructions, so "),e("strong",[s._v("you don't need to install them manually")]),s._v(".")]),s._v(" "),e("p",[s._v("You can also install them manually or use a managed deployment from a cloud provider (Azure, AWS, DigitalOcean, etc). Setting them up manually is out of scope of this article.")])]),s._v(" "),e("h2",{attrs:{id:"run-in-a-virtual-machine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-in-a-virtual-machine"}},[s._v("#")]),s._v(" Run in a Virtual Machine")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("IMPORTANT")]),s._v(" "),e("p",[s._v("This setup is not recommended for use in production for a few reasons, namely:")]),s._v(" "),e("ul",[e("li",[s._v("application level updates: we tend to move quite fast, and if things get busy, blink twice and you’re on an outdated server. this has security implications too.")]),s._v(" "),e("li",[s._v("guaranteed uptime: from our experience, vm’s tend to restart now and then (they need updates and reboots too), which results in downtime.")]),s._v(" "),e("li",[s._v("database backups - again this is up to you mostly on what’s your risk appetite when it comes to dealing with live data. We’re a bit more on the paranoid side, so we’ve set up replication, failover nodes and PITR.")]),s._v(" "),e("li",[s._v("end-to-end encryption: possibly less of daily concern - we’re offering from encryption at rest, to https security (SSL/TLS certs & renewal) - so whenever data travels between a client and the db it’s always encrypted, inc. inside the datacenter itself.")]),s._v(" "),e("li",[s._v("automatic scalability: for example, the preview service can be quite a monster; that setup can eat up all a vm’s resources, and starve other processes causing general system wide instability.")])]),s._v(" "),e("p",[s._v("If you need help deploying a production server, "),e("a",{attrs:{href:"https://speckle.systems/getstarted/",target:"_blank",rel:"noopener noreferrer"}},[s._v("we can help"),e("OutboundLink")],1),s._v("!")])]),s._v(" "),e("p",[s._v("This is the easiest way to get the Server running.")]),s._v(" "),e("p",[s._v("As prerequisites, you only need a Linux VM with at least 4 GB of RAM and have "),e("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker"),e("OutboundLink")],1),s._v(" and "),e("a",{attrs:{href:"https://docs.docker.com/compose/install/#install-compose-on-linux-systems",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Compose"),e("OutboundLink")],1),s._v(" installed.")]),s._v(" "),e("h4",{attrs:{id:"step-1-create-a-directory-for-this-deployment-on-the-system"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-1-create-a-directory-for-this-deployment-on-the-system"}},[s._v("#")]),s._v(" Step 1: Create a directory for this deployment on the system:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# mkdir /opt/speckle/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"step-2-copy-and-paste-this-into-a-file-named-docker-compose-yml-in-your-directory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-copy-and-paste-this-into-a-file-named-docker-compose-yml-in-your-directory"}},[s._v("#")]),s._v(" Step 2: Copy and paste this into a file named "),e("code",[s._v("docker-compose.yml")]),s._v(" in your directory:")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Speckle Server dependencies")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#######")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("postgres")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres:13.1-alpine"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_DB")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_USER")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./postgres"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/postgresql/data/\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:5432:5432"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis:6.0-alpine"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./redis"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:6379:6379"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minio")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minio/minio"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" server /data "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v('address "'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v('9001"\n    '),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./minio"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:9000:9000"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:9001:9001"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Speckle Server")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#######")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("speckle-frontend")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("frontend"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0:80:80"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("speckle-server")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/wait && node bin/www"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change this to the URL of the speckle server, as accessed from the network")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("CANONICAL_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change this to a unique secret for this server")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SESSION_SECRET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TODO:ReplaceWithLongString"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("STRATEGY_LOCAL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle:*"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_USER")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_DB")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("REDIS_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis://redis"')]),s._v("\n      \n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ENDPOINT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://minio:9000"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ACCESS_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_SECRET_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_BUCKET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle-server"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_CREATE_BUCKET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v("\n      \n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WAIT_HOSTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" redis"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" minio"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preview-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("preview"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mem_limit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000m"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memswap_limit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000m"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/wait && node bin/www"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preview-service:*"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WAIT_HOSTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webhook-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webhook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/wait && node main.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webhook-service:*"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WAIT_HOSTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fileimport-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("fileimport"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/wait && node src/daemon.js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileimport-service:*"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("WAIT_HOSTS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ENDPOINT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://minio:9000"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ACCESS_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_SECRET_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_BUCKET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle-server"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SPECKLE_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://speckle-server:3000"')]),s._v("\n      \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br")])]),e("h4",{attrs:{id:"step-3-edit-the-fields-marked-with-todo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-3-edit-the-fields-marked-with-todo"}},[s._v("#")]),s._v(" Step 3: Edit the fields marked with "),e("code",[s._v("TODO")])]),s._v(" "),e("p",[s._v("Make sure to edit the file and change")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("CANONICAL_URL")]),s._v(" to the url used to access this speckle server. This can be "),e("code",[s._v("http://[PUBLIC_IP]")]),s._v(" or "),e("code",[s._v("http://[DOMAIN_NAME]")])]),s._v(" "),e("li",[s._v("For added security, change the "),e("code",[s._v("SESSION_SECRET")]),s._v(" to a unique secret value for this deployment.")])]),s._v(" "),e("p",[s._v("The server also supports some other environment variables. You can see them in our "),e("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/packages/server/.env-example",target:"_blank",rel:"noopener noreferrer"}},[s._v(".env-example file from the git repo"),e("OutboundLink")],1),s._v(".")]),s._v(" "),e("h4",{attrs:{id:"step-4-optionally-add-easy-tls-certificate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-4-optionally-add-easy-tls-certificate"}},[s._v("#")]),s._v(" Step 4: Optionally add easy TLS certificate")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("set up a dns record, that point to the public ip of your VM")])]),s._v(" "),e("li",[e("p",[s._v("add a new entry into the services into the previously defined docker-compose.yml")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("reverse-proxy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" traefik"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v2.5\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--providers.docker"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--entrypoints.websecure.address=:443"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--certificatesresolvers.myresolver.acme.tlschallenge=true"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#- "--certificatesresolvers.myresolver.acme.caserver=https://acme-staging-v02.api.letsencrypt.org/directory"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: replace with proper email")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--certificatesresolvers.myresolver.acme.email={your@example.com}"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--certificatesresolvers.myresolver.acme.storage=/letsencrypt/acme.json"')]),s._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The HTTP port")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"443:443"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The Web UI (enabled by --api.insecure=true)")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8080:8080"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./letsencrypt:/letsencrypt"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# So that Traefik can listen to the Docker events")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /var/run/docker.sock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/run/docker.sock\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("make sure to replace "),e("code",[s._v("{your@example.com}")]),s._v(" for the "),e("code",[s._v("--certificatesresolvers.myresolver.acme.email")]),s._v(" with an email, that belongs to you")])]),s._v(" "),e("li",[e("p",[s._v("modify the frontend service definition with some extra labels like below")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("speckle-frontend")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("frontend"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"traefik.http.routers.speckle-frontend.rule=Host(`{example.com}`)"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"traefik.http.routers.speckle-frontend.entrypoints=websecure"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"traefik.http.routers.speckle-frontend.tls.certresolver=myresolver"')]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("change "),e("code",[s._v("traefik.http.routers.speckle-frontend.rule")]),s._v(" replace "),e("code",[s._v("{example.com}")]),s._v(" with your domain")])]),s._v(" "),e("li",[e("p",[s._v("change "),e("code",[s._v("CANONICAL_URL")]),s._v(" to match "),e("code",[s._v("https://yourdomain")])])])]),s._v(" "),e("h4",{attrs:{id:"step-5-start-the-server-and-the-dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-5-start-the-server-and-the-dependencies"}},[s._v("#")]),s._v(" Step 5: Start the Server and the dependencies")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /opt/speckle")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up -d")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("This will:")]),s._v(" "),e("ul",[e("li",[s._v("Run PostgreSQL inside docker, with data files stored in "),e("code",[s._v("/opt/speckle/postgres-data/")])]),s._v(" "),e("li",[s._v("Run Redis inside docker, with data files stored in "),e("code",[s._v("/opt/speckle/redis-data/")])]),s._v(" "),e("li",[s._v("Run MinIO inside docker, with data files stored in "),e("code",[s._v("/opt/speckle/minio-data/")])]),s._v(" "),e("li",[s._v("Run the Server component, configured for this environment.")]),s._v(" "),e("li",[s._v("Run the Frontend component, exposing port 80 to the network the VM is in.")]),s._v(" "),e("li",[s._v("Run the other microservices for extending the SpeckleServer functionality ( "),e("code",[s._v("preview-service")]),s._v(", "),e("code",[s._v("webhook-service")]),s._v(", "),e("code",[s._v("fileimport-service")]),s._v(" )")])]),s._v(" "),e("p",[s._v("All containers, except the frontend, are not accessible from outside the VM.")]),s._v(" "),e("p",[s._v("All containers automatically start at system startup (so if the VM gets rebooted, the Server will automatically start)")]),s._v(" "),e("h2",{attrs:{id:"run-in-a-vm-without-dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-in-a-vm-without-dependencies"}},[s._v("#")]),s._v(" Run in a VM without dependencies")]),s._v(" "),e("p",[s._v("If you plan to run PostgreSQL, Redis and and S3-compatible object storage service separately, for example as managed deployments by a cloud provider (DigitalOcean, AWS, Azure, etc), you can follow the same instructions as above, but with this simplified "),e("code",[s._v("docker-compose.yml")]),s._v(" file:")]),s._v(" "),e("div",{staticClass:"language-yaml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("speckle-frontend")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("frontend"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0:80:80"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("speckle-server")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change this to the URL of the speckle server, as accessed from the network")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("CANONICAL_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change this to a unique secret for this server")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SESSION_SECRET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"TODO:ReplaceWithLongString"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("STRATEGY_LOCAL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle:*"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to PostgreSQL connection details:")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_USER")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("POSTGRES_DB")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle"')]),s._v("\n      \n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to redis connection string:")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("REDIS_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis://redis"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to ObjectStorage connection information (s3-compatible):")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ENDPOINT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://minio:9000"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ACCESS_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_SECRET_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_BUCKET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle-server"')]),s._v("\n      \n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("preview-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("preview"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mem_limit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000m"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("memswap_limit")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1000m"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"preview-service:*"')]),s._v("\n      \n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to PostgreSQL connection string:")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webhook-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("webhook"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webhook-service:*"')]),s._v("\n      \n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to PostgreSQL connection string:")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("fileimport-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" speckle/speckle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("fileimport"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("DEBUG")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileimport-service:*"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SPECKLE_SERVER_URL")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://speckle-server:3000"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to PostgreSQL connection string:")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PG_CONNECTION_STRING")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres://speckle:speckle@postgres/speckle"')]),s._v("\n\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: Change to ObjectStorage connection information (s3-compatible):")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ENDPOINT")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://minio:9000"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_ACCESS_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_SECRET_KEY")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minioadmin"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("S3_BUCKET")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"speckle-server"')]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br")])]),e("h2",{attrs:{id:"run-your-speckle-server-fork"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-your-speckle-server-fork"}},[s._v("#")]),s._v(" Run your speckle-server fork")]),s._v(" "),e("p",[s._v("If you made some changes to the server and want to run those instead of the official releases, we created some useful docker-compose .yml files to help with that.")]),s._v(" "),e("h4",{attrs:{id:"step-1-set-up-dependencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-1-set-up-dependencies"}},[s._v("#")]),s._v(" Step 1: Set up dependencies")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("If you set up PostgreSQL, Redis and S3-compatible service outside of this VM (for example a managed deployment from a cloud provider), you can skip this step, but remember to set up the correct environment variables later")])]),s._v(" "),e("p",[s._v("To get the PostgreSQL, Redis and MinIO dependencies up and running in the VM, our git repo contains\n"),e("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/docker-compose-deps.yml",target:"_blank",rel:"noopener noreferrer"}},[s._v("a docker-compose file"),e("OutboundLink")],1),s._v("\nfor running these dependencies locally in docker containers.")]),s._v(" "),e("p",[s._v("It also includes "),e("code",[s._v("PGAdmin")]),s._v(" and "),e("code",[s._v("redis-insight")]),s._v(" to be able to explore the raw data. If you don't need them, you can safely remove those entries from the "),e("code",[s._v("docker-compose-deps.yml")]),s._v(" file.")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PATH_TO_SPECKLE-SERVER_REPOSITORY"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n$ docker-compose -f docker-compose-deps.yml up -d\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("This will run the following containers, and will automatically launch them at system startup:")]),s._v(" "),e("ul",[e("li",[e("em",[s._v("PostgreSQL v13")]),s._v(", listening only on "),e("code",[s._v("127.0.0.1:5432")]),s._v(" with default credentials "),e("code",[s._v("speckle")]),s._v(":"),e("code",[s._v("speckle")]),s._v(" and a database named "),e("code",[s._v("speckle")]),s._v(".")]),s._v(" "),e("li",[e("em",[s._v("Redis v6")]),s._v(", listening only on "),e("code",[s._v("127.0.0.1:6379")])]),s._v(" "),e("li",[e("em",[s._v("PGAdmin4")]),s._v(", listening only on "),e("code",[s._v("127.0.0.1:16543")]),s._v(" with default credentials "),e("code",[s._v("admin@localhost")]),s._v(" : "),e("code",[s._v("admin")])]),s._v(" "),e("li",[e("em",[s._v("Redis Insight")]),s._v(", listening only on "),e("code",[s._v("127.0.0.1:8001")])]),s._v(" "),e("li",[e("em",[s._v("MinIO")]),s._v(", listenting on "),e("code",[s._v("127.0.0.1:9000")]),s._v(" with the API endpoint and on "),e("code",[s._v("127.0.0.1:9001")]),s._v(" with the Web Management Interface (default credentials used: "),e("code",[s._v("minioadmin")]),s._v("/"),e("code",[s._v("minioadmin")]),s._v(")")])]),s._v(" "),e("p",[s._v("All of the above containers listen on the local loopback interface ("),e("code",[s._v("127.0.0.1")]),s._v(") and are NOT accessible from the local network (for security, since they use default credentials)")]),s._v(" "),e("p",[s._v("To use PGAdmin, after login you can configure a server connection to the host "),e("code",[s._v("postgres")]),s._v(" (user "),e("code",[s._v("speckle")]),s._v(", password "),e("code",[s._v("speckle")]),s._v(", database "),e("code",[s._v("speckle")]),s._v(")")]),s._v(" "),e("p",[s._v("To use Redis Insight, you can configure it to connect to the hostname "),e("code",[s._v("redis")]),s._v(" (port "),e("code",[s._v("6379")]),s._v(")")]),s._v(" "),e("p",[s._v("Docker-compose creates named docker volumes for storing data for each of the containers, so data is persisted.\nYou can view existing docker volumes with "),e("code",[s._v("docker volume ls")]),s._v(" and delete a volume and existing data with "),e("code",[s._v("docker volume rm [volume_name]")])]),s._v(" "),e("h4",{attrs:{id:"step-2-build-and-run-your-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-build-and-run-your-code"}},[s._v("#")]),s._v(" Step 2: Build and run your code")]),s._v(" "),e("p",[s._v("The git repository contains "),e("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/docker-compose-speckle.yml",target:"_blank",rel:"noopener noreferrer"}},[s._v("a docker-compose file"),e("OutboundLink")],1),s._v(" for building and running the Speckle server frontend and backend in docker containers.")]),s._v(" "),e("p",[s._v("To use it, first edit the variables in the "),e("code",[s._v("docker-compose-speckle.yml")]),s._v(" file to reflect your environment. Then, you can start them with:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PATH_TO_SPECKLE-SERVER_REPOSITORY"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n$ docker-compose -f docker-compose-speckle.yml up --build -d\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("(You can safely ignore the warnings about the "),e("em",[s._v("orphan containers")]),s._v(")")]),s._v(" "),e("p",[s._v("This will run the following containers, and will automatically launch them at system startup:")]),s._v(" "),e("ul",[e("li",[e("em",[s._v("speckle-frontend")]),s._v(", an nginx container that serves the Vue app build as static files (exposed on port 80 in the VM network) and proxies server requests to the "),e("code",[s._v("speckle-server")]),s._v(" container")]),s._v(" "),e("li",[e("em",[s._v("speckle-server")]),s._v(", the "),e("code",[s._v("server")]),s._v(" component that doesn't expose any port outside the internal docker network.")]),s._v(" "),e("li",[e("em",[s._v("preview-service")]),s._v(", the component that generates stream previews. Doesn't expose any port outside the internal docker network.")]),s._v(" "),e("li",[e("em",[s._v("webhook-service")]),s._v(", the component that calls webhooks. Doesn't expose any port.")]),s._v(" "),e("li",[e("em",[s._v("fileimport-service")]),s._v(", the component that imports uploaded files. Doesn't expose any port.")])]),s._v(" "),e("h2",{attrs:{id:"run-in-development-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run-in-development-mode"}},[s._v("#")]),s._v(" Run in development mode")]),s._v(" "),e("p",[s._v("See the dedicated getting started with speckle server development "),e("a",{attrs:{href:"/dev/server-local-dev"}},[s._v("page")]),s._v(".")])])}),[],!1,null,null,null);t.default=n.exports}}]);